# Объединённый файл Main_Merged.html

## Описание

Файл **Main_Merged.html** объединяет функциональность двух предыдущих версий:
- **Main_MSC.html** - логика для московского склада
- **Main_REG.html** - логика для региональных складов

## Основные особенности

### 1. Внешний вид
- Сохранён дизайн и UI из файла MSC (градиентный хедер, стилизованные кнопки, drag-and-drop загрузка)
- Современный интерфейс с анимациями и эффектами

### 2. Автоматическое определение типа расписания

При загрузке файла расписания система автоматически определяет его тип:

#### Расписание MSC определяется по наличию колонок:
- "День недели"
- Другие MSC-специфичные колонки

#### Расписание REG определяется по наличию колонок:
- "ТЦ" (Торговый центр)
- "Временная отмена"
- "Последов-ть загрузки ТЦ"
- "Последов-ть загрузки от кабины"

### 3. Логика обработки данных

#### Для MSC расписания:
- Использование дня недели из даты отгрузки
- Последовательность брендов: VILET=1, ECRU=2, DUB=3, MAAG=4
- Группировка по паллетам и местам
- Внутренняя последовательность: Текстиль, Трансфер, POSM, Оборудование
- Сортировка: Транспорт → Бренд → Внутренняя последовательность

#### Для REG расписания:
- Обогащение данными из расписания (ТЦ, последовательности)
- Нормализация брендов (МААГ→MAAG, ВИЛЕТ→VILET, и т.д.)
- Группировка по уникальным коробам
- Добавление POSM строк после соответствующих брендов
- Сортировка: Последов-ть Бренда в ТС → Последов-ть внутри Бренда → № магазина → Комментарий

### 4. Общие функции

Независимо от типа расписания:
- Фильтрация записей (исключение MOP, POSM из типов заказов)
- Фильтрация магазинов (только числовые номера)
- Опциональная загрузка файла POSM
- Статистика обработки
- Экспорт в Excel
- Печать таблицы
- Предварительный просмотр (первые 100 записей)

## Использование

1. Загрузите файл "Отчёт по ОС на отгрузку"
2. Загрузите файл расписания (MSC или REG - определится автоматически)
3. Опционально загрузите файл POSM
4. Нажмите "Обработать данные"
5. Просмотрите результаты и скачайте Excel или распечатайте

## Сообщения

При загрузке файла расписания появится информационное сообщение:
- "Обнаружено расписание МСК - использую логику MSC"
- "Обнаружено расписание регионов - использую логику REG"
- "Тип расписания не определён - использую логику REG по умолчанию"

## Структура выходных данных

Таблица содержит следующие колонки:
1. Транспорт/№ заказа
2. № магазина
3. Бренд/ТЦ
4. Место
5. Кол-во кор
6. Последов-ть Бренда в ТС
7. Последов-ть внутри Бренда
8. Коммент.

## Технические детали

- Библиотека XLSX: 0.18.5 (CDN)
- Клиентская обработка данных (без серверной части)
- Поддержка форматов: .xlsx, .xls
- Drag-and-drop загрузка файлов
- Адаптивный дизайн (мобильные устройства)
- Print-friendly форматирование

## Совместимость

Файл работает во всех современных браузерах:
- Chrome / Edge
- Firefox
- Safari
- Opera
